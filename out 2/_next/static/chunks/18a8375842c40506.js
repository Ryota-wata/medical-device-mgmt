(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,18566,(e,t,n)=>{t.exports=e.r(76562)},26569,e=>{"use strict";var t=e.i(71645);function n(){let[e,n]=(0,t.useState)("desktop"),[i,o]=(0,t.useState)(window.innerWidth);return(0,t.useEffect)(()=>{let e=()=>{let e=window.innerWidth;o(e),e<768?n("mobile"):e<1024?n("tablet"):n("desktop")};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),{deviceType:e,windowWidth:i,isMobile:"mobile"===e,isTablet:"tablet"===e,isDesktop:"desktop"===e}}e.s(["useResponsive",()=>n])},78828,e=>{"use strict";var t=e.i(43476),n=e.i(18566),i=e.i(71645),o=e.i(26569);function s(){let e=(0,n.useRouter)(),{isMobile:s,isTablet:l}=(0,o.useResponsive)(),[r,p]=(0,i.useState)(null),[x,d]=(0,i.useState)(null),[a,c]=(0,i.useState)(!1),[f,h]=(0,i.useState)("fixed-asset"),[g,u]=(0,i.useState)([]),[y,m]=(0,i.useState)(null);(0,i.useEffect)(()=>{u([]),m(null)},[]);let j=(0,i.useCallback)(e=>{var t;[".xlsx",".xls",".csv"].includes("."+e.name.split(".").pop()?.toLowerCase())?e.size>0xa00000?alert("ファイルサイズが大きすぎます。10MB以下のファイルをアップロードしてください。"):(p(e),d({name:e.name,size:(t=e.size)<1024?t+" B":t<1048576?(t/1024).toFixed(2)+" KB":(t/1048576).toFixed(2)+" MB",rows:"解析中..."}),setTimeout(()=>{d(e=>e?{...e,rows:"150 件"}:null)},500)):alert("対応していないファイル形式です。.xlsx, .xls, .csv のファイルをアップロードしてください。")},[]),b=()=>{e.push("/asset-matching")},v=g.some(e=>"fixed-asset"===e.type),w=g.some(e=>"me-ledger"===e.type);return(0,t.jsxs)("div",{style:{minHeight:"100vh",background:"#f5f6f8",display:"flex",flexDirection:"column"},children:[(0,t.jsx)("header",{style:{background:"linear-gradient(135deg, #2c3e50 0%, #34495e 100%)",color:"white",padding:s?"16px 20px":l?"20px 24px":"24px 32px",boxShadow:"0 2px 8px rgba(0,0,0,0.15)"},children:(0,t.jsx)("h1",{style:{fontSize:s?"18px":l?"22px":"26px",fontWeight:700,margin:0},children:"固定資産管理台帳取込"})}),(0,t.jsx)("main",{style:{flex:1,padding:s?"20px":l?"32px":"48px",maxWidth:"1000px",margin:"0 auto",width:"100%",boxSizing:"border-box"},children:(0,t.jsxs)("div",{style:{background:"white",borderRadius:"12px",padding:s?"24px":l?"32px":"40px",boxShadow:"0 2px 12px rgba(0,0,0,0.08)"},children:[y&&(0,t.jsxs)("div",{style:{background:"#e3f2fd",border:"1px solid #2196f3",borderRadius:"8px",padding:s?"16px":"20px",marginBottom:s?"24px":"32px"},children:[(0,t.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[(0,t.jsx)("h3",{style:{fontSize:s?"15px":"16px",fontWeight:700,color:"#1976d2",margin:0},children:"📊 突き合わせ作業が途中です"}),(0,t.jsx)("button",{onClick:b,style:{padding:"8px 20px",background:"#2196f3",color:"white",border:"none",borderRadius:"6px",fontSize:s?"13px":"14px",fontWeight:600,cursor:"pointer"},children:"作業を再開する"})]}),(0,t.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"8px",fontSize:s?"13px":"14px",color:"#1565c0"},children:[(0,t.jsxs)("div",{children:["全体: ",y.totalRows," 件"]}),(0,t.jsxs)("div",{children:["完了: ",y.completedRows," 件 / 未処理: ",y.pendingRows," 件"]}),(0,t.jsx)("div",{style:{width:"100%",height:"8px",backgroundColor:"#bbdefb",borderRadius:"4px",overflow:"hidden",marginTop:"8px"},children:(0,t.jsx)("div",{style:{width:`${y.completedRows/y.totalRows*100}%`,height:"100%",backgroundColor:"#1976d2",transition:"width 0.3s"}})})]})]}),g.length>0&&(0,t.jsxs)("div",{style:{background:"#f1f8e9",border:"1px solid #8bc34a",borderRadius:"8px",padding:s?"16px":"20px",marginBottom:s?"24px":"32px"},children:[(0,t.jsx)("h3",{style:{fontSize:s?"15px":"16px",fontWeight:700,color:"#558b2f",marginBottom:"12px"},children:"✓ アップロード済みファイル"}),(0,t.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:g.map((e,n)=>(0,t.jsxs)("div",{style:{background:"white",border:"1px solid #c5e1a5",borderRadius:"6px",padding:"12px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,t.jsxs)("div",{style:{flex:1},children:[(0,t.jsx)("div",{style:{fontSize:s?"13px":"14px",fontWeight:600,color:"#2c3e50",marginBottom:"4px"},children:"fixed-asset"===e.type?"固定資産管理台帳":"その他台帳"}),(0,t.jsxs)("div",{style:{fontSize:s?"12px":"13px",color:"#7f8c8d"},children:[e.name," (",e.size," / ",e.rows,")"]}),(0,t.jsxs)("div",{style:{fontSize:s?"11px":"12px",color:"#95a5a6",marginTop:"4px"},children:["アップロード日時: ",e.uploadedAt]})]}),(0,t.jsx)("button",{onClick:()=>{confirm("このファイルを削除しますか？突き合わせ途中のデータも削除されます。")&&(u(e=>e.filter((e,t)=>t!==n)),1===g.length&&m(null))},style:{background:"#e74c3c",color:"white",border:"none",borderRadius:"4px",padding:"6px 12px",fontSize:"12px",cursor:"pointer"},children:"削除"})]},n))})]}),(0,t.jsxs)("div",{style:{marginBottom:s?"24px":"32px"},children:[(0,t.jsx)("h2",{style:{fontSize:s?"18px":"20px",fontWeight:700,color:"#2c3e50",marginBottom:"12px"},children:0===g.length?"Excelファイルをアップロードしてください":"追加のファイルをアップロード"}),(0,t.jsx)("p",{style:{fontSize:s?"14px":"15px",color:"#7f8c8d",lineHeight:1.6},children:"固定資産管理台帳またはその他台帳のExcelファイル（.xlsx, .xls）またはCSVファイル（.csv）をアップロードできます。"})]}),(0,t.jsxs)("div",{style:{marginBottom:s?"24px":"32px"},children:[(0,t.jsx)("h3",{style:{fontSize:s?"15px":"16px",fontWeight:700,color:"#2c3e50",marginBottom:"12px"},children:"アップロードするファイルの種類を選択"}),(0,t.jsxs)("div",{style:{display:"flex",gap:"24px",flexWrap:"wrap"},children:[(0,t.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:"8px",cursor:"pointer",fontSize:s?"14px":"15px",color:"#2c3e50"},children:[(0,t.jsx)("input",{type:"radio",name:"fileType",value:"fixed-asset",checked:"fixed-asset"===f,onChange:e=>h(e.target.value),style:{cursor:"pointer"}}),(0,t.jsx)("span",{children:"固定資産管理台帳"}),v&&(0,t.jsx)("span",{style:{color:"#4caf50",fontSize:"12px"},children:"✓ 済"})]}),(0,t.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:"8px",cursor:"pointer",fontSize:s?"14px":"15px",color:"#2c3e50"},children:[(0,t.jsx)("input",{type:"radio",name:"fileType",value:"me-ledger",checked:"me-ledger"===f,onChange:e=>h(e.target.value),style:{cursor:"pointer"}}),(0,t.jsx)("span",{children:"その他台帳"}),w&&(0,t.jsx)("span",{style:{color:"#4caf50",fontSize:"12px"},children:"✓ 済"})]})]})]}),(0,t.jsxs)("div",{onDrop:e=>{e.preventDefault(),e.stopPropagation(),c(!1);let t=e.dataTransfer.files;t.length>0&&j(t[0])},onDragOver:e=>{e.preventDefault(),e.stopPropagation(),c(!0)},onDragLeave:e=>{e.preventDefault(),e.stopPropagation(),c(!1)},style:{border:`2px dashed ${a?"#27ae60":"#d0d0d0"}`,borderRadius:"12px",padding:s?"40px 20px":l?"60px 40px":"80px 40px",textAlign:"center",background:a?"#f0f8f4":"#fafbfc",transition:"all 0.3s",marginBottom:s?"24px":"32px"},children:[(0,t.jsx)("div",{style:{fontSize:s?"48px":"64px",marginBottom:"16px"},children:"📁"}),(0,t.jsx)("p",{style:{fontSize:s?"15px":"17px",fontWeight:600,color:"#2c3e50",marginBottom:"8px"},children:"ここにファイルをドラッグ&ドロップ"}),(0,t.jsx)("p",{style:{fontSize:s?"13px":"14px",color:"#95a5a6",marginBottom:"20px"},children:"または"}),(0,t.jsx)("input",{type:"file",id:"fileInput",accept:".xlsx,.xls,.csv",style:{display:"none"},onChange:e=>{let t=e.target.files;t&&t.length>0&&j(t[0])}}),(0,t.jsx)("button",{onClick:()=>document.getElementById("fileInput")?.click(),style:{padding:s?"12px 28px":"14px 32px",background:"#27ae60",color:"white",border:"none",borderRadius:"8px",fontSize:s?"14px":"15px",fontWeight:600,cursor:"pointer",marginBottom:"16px"},children:"ファイルを選択"}),(0,t.jsx)("p",{style:{fontSize:s?"12px":"13px",color:"#95a5a6"},children:"対応形式: .xlsx, .xls, .csv （最大サイズ: 10MB）"})]}),x&&(0,t.jsxs)("div",{style:{background:"#f8f9fa",border:"1px solid #e0e0e0",borderRadius:"8px",padding:s?"16px":"20px",marginBottom:s?"24px":"32px"},children:[(0,t.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[(0,t.jsx)("h3",{style:{fontSize:s?"15px":"16px",fontWeight:700,color:"#2c3e50",margin:0},children:"選択済みファイル"}),(0,t.jsx)("button",{onClick:()=>{p(null),d(null)},style:{background:"#e74c3c",color:"white",border:"none",borderRadius:"50%",width:"28px",height:"28px",fontSize:"18px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},children:"×"})]}),(0,t.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:[(0,t.jsxs)("div",{style:{display:"flex",flexWrap:"wrap",gap:"8px"},children:[(0,t.jsx)("span",{style:{fontSize:s?"13px":"14px",color:"#7f8c8d",fontWeight:600},children:"ファイル名:"}),(0,t.jsx)("span",{style:{fontSize:s?"13px":"14px",color:"#2c3e50"},children:x.name})]}),(0,t.jsxs)("div",{style:{display:"flex",flexWrap:"wrap",gap:"8px"},children:[(0,t.jsx)("span",{style:{fontSize:s?"13px":"14px",color:"#7f8c8d",fontWeight:600},children:"ファイルサイズ:"}),(0,t.jsx)("span",{style:{fontSize:s?"13px":"14px",color:"#2c3e50"},children:x.size})]}),(0,t.jsxs)("div",{style:{display:"flex",flexWrap:"wrap",gap:"8px"},children:[(0,t.jsx)("span",{style:{fontSize:s?"13px":"14px",color:"#7f8c8d",fontWeight:600},children:"データ件数:"}),(0,t.jsx)("span",{style:{fontSize:s?"13px":"14px",color:"#2c3e50"},children:x.rows})]})]})]}),(0,t.jsxs)("div",{style:{background:"#fff9e6",border:"1px solid #ffd966",borderRadius:"8px",padding:s?"16px":"20px",marginBottom:s?"24px":"32px"},children:[(0,t.jsx)("h3",{style:{fontSize:s?"14px":"15px",fontWeight:700,color:"#d68910",marginBottom:"12px"},children:"📌 アップロード時の注意事項"}),(0,t.jsxs)("ul",{style:{fontSize:s?"13px":"14px",color:"#7f8c8d",lineHeight:1.8,paddingLeft:"20px",margin:0},children:[(0,t.jsx)("li",{children:"Excelファイルの1行目はヘッダー行として認識されます"}),(0,t.jsx)("li",{children:"データは2行目から読み込まれます"}),(0,t.jsx)("li",{children:"空白行は自動的にスキップされます"}),(0,t.jsx)("li",{children:"必須項目: 資産番号、品名、取得年月日"})]})]}),(0,t.jsxs)("div",{style:{display:"flex",gap:"16px",flexDirection:s?"column":"row",justifyContent:"space-between"},children:[(0,t.jsxs)("button",{onClick:()=>e.push("/main"),style:{flex:s?"none":1,padding:"14px 24px",background:"#95a5a6",color:"white",border:"none",borderRadius:"8px",fontSize:s?"14px":"15px",fontWeight:600,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:[(0,t.jsx)("span",{children:"←"}),(0,t.jsx)("span",{children:"メイン画面に戻る"})]}),r&&x?(0,t.jsxs)("button",{onClick:()=>{if(!r||!x)return void alert("ファイルを選択してください");let t={type:f,name:x.name,size:x.size,rows:x.rows,uploadedAt:new Date().toLocaleString("ja-JP",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})};u(e=>[...e,t]),p(null),d(null),e.push("/asset-matching")},style:{flex:s?"none":1,padding:"14px 24px",background:"#27ae60",color:"white",border:"none",borderRadius:"8px",fontSize:s?"14px":"15px",fontWeight:600,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:[(0,t.jsx)("span",{children:"アップロードして突き合わせへ"}),(0,t.jsx)("span",{children:"→"})]}):g.length>0?(0,t.jsxs)("button",{onClick:b,style:{flex:s?"none":1,padding:"14px 24px",background:"#2196f3",color:"white",border:"none",borderRadius:"8px",fontSize:s?"14px":"15px",fontWeight:600,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:[(0,t.jsx)("span",{children:"突き合わせ画面へ"}),(0,t.jsx)("span",{children:"→"})]}):(0,t.jsxs)("button",{onClick:()=>e.push("/asset-matching"),style:{flex:s?"none":1,padding:"14px 24px",background:"#27ae60",color:"white",border:"none",borderRadius:"8px",fontSize:s?"14px":"15px",fontWeight:600,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:[(0,t.jsx)("span",{children:"次へ"}),(0,t.jsx)("span",{children:"→"})]})]})]})})]})}e.s(["default",()=>s])}]);